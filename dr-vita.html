<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Dr. Vita</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Geist:wght@100;200;300;400;500;600;700;800;900&family=Geist+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    @font-face {
      font-family: 'Geist';
      src: url('https://cdn.jsdelivr.net/npm/geist@1.2.2/dist/fonts/geist-sans/Geist-Regular.woff2') format('woff2');
      font-weight: 400;
      font-style: normal;
    }
    @font-face {
      font-family: 'Geist';
      src: url('https://cdn.jsdelivr.net/npm/geist@1.2.2/dist/fonts/geist-sans/Geist-Medium.woff2') format('woff2');
      font-weight: 500;
      font-style: normal;
    }
    @font-face {
      font-family: 'Geist';
      src: url('https://cdn.jsdelivr.net/npm/geist@1.2.2/dist/fonts/geist-sans/Geist-SemiBold.woff2') format('woff2');
      font-weight: 600;
      font-style: normal;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      /* Dark Glassmorphism Palette */
      --bg-primary: #050505;
      --bg-secondary: #0a0a0a;
      --bg-tertiary: #111111;
      --bg-elevated: #161616;

      /* Glass surfaces */
      --glass-bg: rgba(255, 255, 255, 0.03);
      --glass-bg-hover: rgba(255, 255, 255, 0.06);
      --glass-border: rgba(255, 255, 255, 0.08);
      --glass-border-light: rgba(255, 255, 255, 0.12);

      /* Text hierarchy */
      --text-primary: rgba(255, 255, 255, 0.95);
      --text-secondary: rgba(255, 255, 255, 0.6);
      --text-tertiary: rgba(255, 255, 255, 0.4);
      --text-quaternary: rgba(255, 255, 255, 0.2);

      /* Accent colors - Vibrant gradients */
      --accent-cyan: #00D4FF;
      --accent-blue: #0066FF;
      --accent-purple: #8B5CF6;
      --accent-pink: #EC4899;
      --accent-green: #10B981;
      --accent-amber: #F59E0B;
      --accent-red: #EF4444;

      /* Gradient definitions */
      --gradient-primary: linear-gradient(135deg, #00D4FF 0%, #0066FF 50%, #8B5CF6 100%);
      --gradient-secondary: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%);
      --gradient-success: linear-gradient(135deg, #10B981 0%, #059669 100%);
      --gradient-warning: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
      --gradient-danger: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
      --gradient-mesh: radial-gradient(at 40% 20%, rgba(0, 212, 255, 0.15) 0px, transparent 50%),
                       radial-gradient(at 80% 0%, rgba(139, 92, 246, 0.15) 0px, transparent 50%),
                       radial-gradient(at 0% 50%, rgba(236, 72, 153, 0.1) 0px, transparent 50%),
                       radial-gradient(at 80% 50%, rgba(0, 102, 255, 0.1) 0px, transparent 50%),
                       radial-gradient(at 0% 100%, rgba(16, 185, 129, 0.1) 0px, transparent 50%);

      /* Typography */
      --font-sans: 'Geist', -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
      --font-mono: 'Geist Mono', 'SF Mono', 'Fira Code', monospace;

      /* Spacing scale */
      --space-1: 4px;
      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --space-6: 24px;
      --space-8: 32px;
      --space-10: 40px;
      --space-12: 48px;
      --space-16: 64px;

      /* Border radius */
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-2xl: 32px;
      --radius-full: 9999px;

      /* Transitions */
      --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
      --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 400ms;
    }

    html {
      font-family: var(--font-sans);
      background: var(--bg-primary);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }

    body {
      min-height: 100vh;
      min-height: 100dvh;
      overflow: hidden;
      background: var(--bg-primary);
    }

    #app {
      min-height: 100vh;
      min-height: 100dvh;
    }

    /* Mobile Frame */
    .mobile-frame {
      max-width: 430px;
      margin: 0 auto;
      min-height: 100vh;
      min-height: 100dvh;
      background: var(--bg-primary);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Animated Mesh Background */
    .mesh-bg {
      position: fixed;
      inset: 0;
      background: var(--gradient-mesh);
      opacity: 1;
      z-index: 0;
      animation: mesh-float 20s ease-in-out infinite;
    }

    @keyframes mesh-float {
      0%, 100% { transform: translate(0, 0) scale(1); }
      25% { transform: translate(2%, 2%) scale(1.02); }
      50% { transform: translate(-1%, 3%) scale(1.01); }
      75% { transform: translate(1%, -2%) scale(1.03); }
    }

    /* Noise overlay for texture */
    .noise-overlay {
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 1;
    }

    /* ==================== */
    /* MAIN CONTAINER       */
    /* ==================== */

    .vita-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 2;
    }

    /* Status Bar */
    .status-bar {
      height: 54px;
      padding: 0 var(--space-6);
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      padding-bottom: var(--space-2);
    }

    .status-bar-time {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }

    .status-bar-icons {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .status-bar-icons svg {
      width: 18px;
      height: 18px;
      color: var(--text-primary);
    }

    /* ==================== */
    /* THE ORB              */
    /* ==================== */

    .orb-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-6);
      position: relative;
    }

    .orb-container {
      position: relative;
      width: 280px;
      height: 280px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Outer glow rings */
    .orb-glow {
      position: absolute;
      inset: -40px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0, 212, 255, 0.08) 0%, transparent 70%);
      animation: glow-pulse 4s ease-in-out infinite;
    }

    .orb-glow-2 {
      position: absolute;
      inset: -60px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(139, 92, 246, 0.05) 0%, transparent 60%);
      animation: glow-pulse 4s ease-in-out infinite 1s;
    }

    @keyframes glow-pulse {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.05); opacity: 1; }
    }

    /* The main orb */
    .orb {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      position: relative;
      cursor: pointer;
      transition: transform var(--duration-slow) var(--ease-spring);
    }

    .orb:hover {
      transform: scale(1.02);
    }

    .orb:active {
      transform: scale(0.98);
    }

    /* Glass sphere effect */
    .orb-glass {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.05) 50%,
        rgba(255, 255, 255, 0.02) 100%
      );
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow:
        inset 0 1px 1px rgba(255, 255, 255, 0.1),
        0 0 80px rgba(0, 212, 255, 0.2),
        0 0 120px rgba(139, 92, 246, 0.15);
    }

    /* Inner gradient animation */
    .orb-inner {
      position: absolute;
      inset: 20px;
      border-radius: 50%;
      background: conic-gradient(
        from 0deg,
        var(--accent-cyan),
        var(--accent-blue),
        var(--accent-purple),
        var(--accent-pink),
        var(--accent-purple),
        var(--accent-blue),
        var(--accent-cyan)
      );
      opacity: 0.6;
      filter: blur(20px);
      animation: orb-rotate 8s linear infinite;
    }

    @keyframes orb-rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Specular highlight */
    .orb-highlight {
      position: absolute;
      top: 15%;
      left: 20%;
      width: 40%;
      height: 25%;
      background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.4) 0%,
        rgba(255, 255, 255, 0.1) 50%,
        transparent 100%
      );
      border-radius: 50%;
      filter: blur(10px);
      pointer-events: none;
    }

    /* Voice visualization */
    .voice-viz {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      opacity: 0;
      transition: opacity var(--duration-normal) ease;
    }

    .orb.listening .voice-viz {
      opacity: 1;
    }

    .voice-bar {
      width: 4px;
      background: linear-gradient(180deg, var(--accent-cyan), var(--accent-purple));
      border-radius: 2px;
      transition: height 80ms ease;
    }

    /* Speaking ripples */
    .speak-ripple {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      border: 1px solid var(--accent-cyan);
      opacity: 0;
      pointer-events: none;
    }

    .orb.speaking .speak-ripple {
      animation: ripple-expand 2s ease-out infinite;
    }

    .orb.speaking .speak-ripple:nth-child(2) { animation-delay: 0.6s; }
    .orb.speaking .speak-ripple:nth-child(3) { animation-delay: 1.2s; }

    @keyframes ripple-expand {
      0% { transform: scale(1); opacity: 0.5; }
      100% { transform: scale(2); opacity: 0; }
    }

    /* Thinking state */
    .orb.thinking .orb-inner {
      animation: orb-rotate 2s linear infinite;
      opacity: 0.8;
    }

    /* ==================== */
    /* STATUS TEXT          */
    /* ==================== */

    .status-section {
      text-align: center;
      margin-top: var(--space-10);
      padding: 0 var(--space-6);
    }

    .greeting {
      font-size: 32px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.03em;
      margin-bottom: var(--space-3);
      line-height: 1.1;
    }

    .status-message {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-secondary);
      line-height: 1.5;
      max-width: 300px;
      margin: 0 auto;
    }

    .last-check {
      font-size: 13px;
      color: var(--text-tertiary);
      margin-top: var(--space-4);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
    }

    .last-check::before {
      content: '';
      width: 6px;
      height: 6px;
      background: var(--accent-green);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--accent-green);
    }

    /* ==================== */
    /* QUICK ACTIONS        */
    /* ==================== */

    .quick-actions {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-3);
      justify-content: center;
      padding: var(--space-8) var(--space-6);
      margin-top: auto;
    }

    .quick-action {
      padding: var(--space-3) var(--space-5);
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      font-family: var(--font-sans);
      transition: all var(--duration-fast) ease;
    }

    .quick-action:hover {
      background: var(--glass-bg-hover);
      border-color: var(--glass-border-light);
      color: var(--text-primary);
      transform: translateY(-1px);
    }

    .quick-action:active {
      transform: translateY(0);
    }

    /* ==================== */
    /* TALK BUTTON          */
    /* ==================== */

    .talk-section {
      padding: var(--space-6) var(--space-6) var(--space-10);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-4);
    }

    .talk-btn {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: var(--gradient-primary);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      transition: all var(--duration-normal) var(--ease-spring);
      box-shadow:
        0 4px 24px rgba(0, 212, 255, 0.3),
        0 8px 48px rgba(139, 92, 246, 0.2);
    }

    .talk-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%);
      border-radius: 50%;
    }

    .talk-btn:hover {
      transform: scale(1.05);
      box-shadow:
        0 6px 32px rgba(0, 212, 255, 0.4),
        0 12px 64px rgba(139, 92, 246, 0.3);
    }

    .talk-btn:active {
      transform: scale(0.95);
    }

    .talk-btn.listening {
      background: var(--gradient-danger);
      box-shadow:
        0 4px 24px rgba(239, 68, 68, 0.4),
        0 8px 48px rgba(239, 68, 68, 0.2);
      animation: recording-pulse 1.5s ease-in-out infinite;
    }

    @keyframes recording-pulse {
      0%, 100% { box-shadow: 0 4px 24px rgba(239, 68, 68, 0.4); }
      50% { box-shadow: 0 4px 48px rgba(239, 68, 68, 0.6); }
    }

    .talk-btn svg {
      width: 28px;
      height: 28px;
      color: white;
      position: relative;
      z-index: 1;
    }

    .talk-hint {
      font-size: 13px;
      color: var(--text-tertiary);
      letter-spacing: 0.02em;
    }

    /* ==================== */
    /* BOTTOM NAV           */
    /* ==================== */

    .bottom-nav {
      display: flex;
      justify-content: space-around;
      padding: var(--space-3) var(--space-6);
      padding-bottom: calc(var(--space-6) + env(safe-area-inset-bottom, 0px));
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid var(--glass-border);
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-1);
      padding: var(--space-2) var(--space-4);
      background: none;
      border: none;
      cursor: pointer;
      transition: all var(--duration-fast) ease;
    }

    .nav-item svg {
      width: 24px;
      height: 24px;
      color: var(--text-tertiary);
      transition: color var(--duration-fast) ease;
    }

    .nav-item span {
      font-size: 10px;
      font-weight: 500;
      color: var(--text-tertiary);
      font-family: var(--font-sans);
      letter-spacing: 0.02em;
    }

    .nav-item.active svg {
      color: var(--text-primary);
    }

    .nav-item.active span {
      color: var(--text-primary);
    }

    .nav-item:hover svg,
    .nav-item:hover span {
      color: var(--text-secondary);
    }

    /* ==================== */
    /* CONVERSATION VIEW    */
    /* ==================== */

    .conversation-view {
      position: absolute;
      inset: 0;
      background: var(--bg-primary);
      display: flex;
      flex-direction: column;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: all var(--duration-slow) var(--ease-out);
    }

    .conversation-view.active {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .convo-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-4) var(--space-5);
      padding-top: calc(var(--space-4) + 44px);
      border-bottom: 1px solid var(--glass-border);
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    .convo-back {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--duration-fast) ease;
    }

    .convo-back:hover {
      background: var(--glass-bg-hover);
    }

    .convo-back svg {
      width: 20px;
      height: 20px;
      color: var(--text-primary);
    }

    .convo-title {
      font-size: 17px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }

    .convo-escalate {
      padding: var(--space-2) var(--space-4);
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      font-size: 13px;
      font-weight: 500;
      color: var(--accent-cyan);
      cursor: pointer;
      font-family: var(--font-sans);
      transition: all var(--duration-fast) ease;
    }

    .convo-escalate:hover {
      background: rgba(0, 212, 255, 0.1);
      border-color: var(--accent-cyan);
    }

    /* Messages */
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-5);
      display: flex;
      flex-direction: column;
      gap: var(--space-4);
    }

    .message {
      max-width: 85%;
      animation: msg-in 0.4s var(--ease-out);
    }

    @keyframes msg-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .message.vita { align-self: flex-start; }
    .message.user { align-self: flex-end; }

    .msg-bubble {
      padding: var(--space-4) var(--space-5);
      border-radius: var(--radius-xl);
      font-size: 15px;
      line-height: 1.5;
      letter-spacing: -0.01em;
    }

    .message.vita .msg-bubble {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      color: var(--text-primary);
      border-bottom-left-radius: var(--radius-sm);
    }

    .message.user .msg-bubble {
      background: var(--gradient-primary);
      color: white;
      border-bottom-right-radius: var(--radius-sm);
    }

    .msg-time {
      font-size: 11px;
      color: var(--text-quaternary);
      margin-top: var(--space-1);
      padding: 0 var(--space-2);
    }

    .message.user .msg-time { text-align: right; }

    /* Typing indicator */
    .typing {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: var(--space-4) var(--space-5);
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      border-bottom-left-radius: var(--radius-sm);
      width: fit-content;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      background: var(--text-tertiary);
      border-radius: 50%;
      animation: typing-bounce 1.4s ease-in-out infinite;
    }

    .typing-dot:nth-child(2) { animation-delay: 0.15s; }
    .typing-dot:nth-child(3) { animation-delay: 0.3s; }

    @keyframes typing-bounce {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
      30% { transform: translateY(-6px); opacity: 1; }
    }

    /* Input area */
    .convo-input {
      padding: var(--space-4) var(--space-5);
      padding-bottom: calc(var(--space-5) + env(safe-area-inset-bottom, 0px));
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid var(--glass-border);
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .convo-input input {
      flex: 1;
      height: 48px;
      padding: 0 var(--space-5);
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      font-size: 15px;
      font-family: var(--font-sans);
      color: var(--text-primary);
      transition: all var(--duration-fast) ease;
    }

    .convo-input input:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
    }

    .convo-input input::placeholder {
      color: var(--text-tertiary);
    }

    .input-mic {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--gradient-primary);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--duration-fast) ease;
      flex-shrink: 0;
    }

    .input-mic:hover {
      transform: scale(1.05);
    }

    .input-mic.active {
      background: var(--gradient-danger);
    }

    .input-mic svg {
      width: 22px;
      height: 22px;
      color: white;
    }

    /* ==================== */
    /* CANVAS OVERLAYS      */
    /* ==================== */

    .canvas {
      position: absolute;
      inset: 0;
      background: rgba(5, 5, 5, 0.95);
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-10) var(--space-6);
      z-index: 60;
      opacity: 0;
      pointer-events: none;
      transition: all var(--duration-slow) var(--ease-out);
    }

    .canvas.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* Body Map */
    .body-map-wrap {
      width: 100%;
      max-width: 260px;
    }

    .body-map svg {
      width: 100%;
      height: auto;
    }

    .body-part {
      fill: var(--glass-bg);
      stroke: var(--glass-border);
      stroke-width: 1;
      cursor: pointer;
      transition: all var(--duration-fast) ease;
    }

    .body-part:hover {
      fill: rgba(0, 212, 255, 0.1);
      stroke: var(--accent-cyan);
    }

    .body-part.selected {
      fill: rgba(0, 212, 255, 0.2);
      stroke: var(--accent-cyan);
      stroke-width: 2;
      filter: drop-shadow(0 0 8px rgba(0, 212, 255, 0.4));
    }

    .body-instruction {
      text-align: center;
      margin-top: var(--space-6);
      font-size: 15px;
      color: var(--text-secondary);
    }

    /* Severity slider */
    .severity-wrap {
      width: 100%;
      max-width: 300px;
      margin-top: var(--space-8);
    }

    .severity-labels {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--text-tertiary);
      margin-bottom: var(--space-3);
    }

    .severity-slider {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: linear-gradient(90deg, var(--accent-green), var(--accent-amber), var(--accent-red));
      border-radius: 3px;
      outline: none;
    }

    .severity-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      border: 2px solid var(--bg-primary);
    }

    .severity-value {
      text-align: center;
      font-size: 56px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-top: var(--space-4);
      letter-spacing: -0.03em;
    }

    .canvas-btn {
      margin-top: var(--space-8);
      padding: var(--space-4) var(--space-8);
      background: var(--gradient-primary);
      border: none;
      border-radius: var(--radius-full);
      font-size: 16px;
      font-weight: 600;
      color: white;
      cursor: pointer;
      font-family: var(--font-sans);
      transition: all var(--duration-fast) ease;
    }

    .canvas-btn:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 24px rgba(0, 212, 255, 0.3);
    }

    /* ==================== */
    /* TRIAGE RESULT        */
    /* ==================== */

    .triage-card {
      width: 100%;
      max-width: 340px;
      background: var(--glass-bg);
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-2xl);
      padding: var(--space-8);
      text-align: center;
    }

    .triage-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-5);
      font-size: 36px;
    }

    .triage-icon.self-care {
      background: rgba(16, 185, 129, 0.15);
      box-shadow: 0 0 40px rgba(16, 185, 129, 0.2);
    }

    .triage-icon.schedule {
      background: rgba(245, 158, 11, 0.15);
      box-shadow: 0 0 40px rgba(245, 158, 11, 0.2);
    }

    .triage-icon.urgent {
      background: rgba(239, 68, 68, 0.15);
      box-shadow: 0 0 40px rgba(239, 68, 68, 0.2);
    }

    .triage-level {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: var(--space-2);
    }

    .triage-level.self-care { color: var(--accent-green); }
    .triage-level.schedule { color: var(--accent-amber); }
    .triage-level.urgent { color: var(--accent-red); }

    .triage-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.02em;
      margin-bottom: var(--space-3);
    }

    .triage-desc {
      font-size: 15px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: var(--space-6);
    }

    .triage-actions {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .triage-btn {
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      font-family: var(--font-sans);
      transition: all var(--duration-fast) ease;
      border: none;
    }

    .triage-btn.primary {
      background: var(--gradient-primary);
      color: white;
    }

    .triage-btn.primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    }

    .triage-btn.secondary {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      color: var(--text-primary);
    }

    .triage-btn.secondary:hover {
      background: var(--glass-bg-hover);
    }

    /* ==================== */
    /* FAMILY HUB           */
    /* ==================== */

    .family-hub {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-secondary);
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
      border: 1px solid var(--glass-border);
      border-bottom: none;
      padding: var(--space-6);
      padding-bottom: calc(var(--space-6) + env(safe-area-inset-bottom, 0px));
      transform: translateY(100%);
      transition: transform var(--duration-slow) var(--ease-out);
      z-index: 70;
      max-height: 70vh;
      overflow-y: auto;
    }

    .family-hub.active {
      transform: translateY(0);
    }

    .family-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-5);
    }

    .family-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }

    .family-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .family-close svg {
      width: 16px;
      height: 16px;
      color: var(--text-secondary);
    }

    .family-member {
      display: flex;
      align-items: center;
      padding: var(--space-4);
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-3);
      cursor: pointer;
      transition: all var(--duration-fast) ease;
    }

    .family-member:hover {
      background: var(--glass-bg-hover);
      border-color: var(--glass-border-light);
    }

    .family-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--gradient-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      font-weight: 600;
      color: white;
      margin-right: var(--space-4);
    }

    .family-info { flex: 1; }

    .family-name {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .family-relation {
      font-size: 13px;
      color: var(--text-tertiary);
      margin-top: 2px;
    }

    .family-status {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: 12px;
      color: var(--text-secondary);
    }

    .family-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .family-dot.good { background: var(--accent-green); box-shadow: 0 0 8px var(--accent-green); }
    .family-dot.attention { background: var(--accent-amber); box-shadow: 0 0 8px var(--accent-amber); }
    .family-dot.concern { background: var(--accent-red); box-shadow: 0 0 8px var(--accent-red); }

    .add-family {
      width: 100%;
      padding: var(--space-4);
      background: transparent;
      border: 1px dashed var(--glass-border);
      border-radius: var(--radius-lg);
      font-size: 14px;
      font-weight: 500;
      color: var(--text-tertiary);
      cursor: pointer;
      font-family: var(--font-sans);
      transition: all var(--duration-fast) ease;
    }

    .add-family:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    /* ==================== */
    /* DISCLAIMER           */
    /* ==================== */

    .disclaimer {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      max-width: 360px;
      width: calc(100% - 40px);
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: var(--space-4) var(--space-5);
      font-size: 12px;
      color: var(--text-tertiary);
      text-align: center;
      line-height: 1.5;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: all var(--duration-slow) var(--ease-out);
    }

    .disclaimer.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%) translateY(0);
    }

    .disclaimer-close {
      position: absolute;
      top: var(--space-2);
      right: var(--space-2);
      width: 24px;
      height: 24px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .disclaimer-close:hover {
      color: var(--text-secondary);
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 2px; }
  </style>
</head>
<body>
  <div id="app">
    <!-- Animated mesh background -->
    <div class="mesh-bg"></div>
    <div class="noise-overlay"></div>

    <div class="mobile-frame">
      <div class="vita-container">
        <!-- Status Bar -->
        <div class="status-bar">
          <span class="status-bar-time">{{ currentTime }}</span>
          <div class="status-bar-icons">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
          </div>
        </div>

        <!-- Main Home View -->
        <div class="orb-section" v-if="!showConversation">
          <!-- The Orb -->
          <div class="orb-container">
            <div class="orb-glow"></div>
            <div class="orb-glow-2"></div>
            <div
              class="orb"
              :class="{ listening: isListening, speaking: isSpeaking, thinking: isThinking }"
              @click="toggleListening"
            >
              <div class="orb-glass"></div>
              <div class="orb-inner"></div>
              <div class="orb-highlight"></div>

              <!-- Voice visualization -->
              <div class="voice-viz">
                <div v-for="i in 7" :key="i" class="voice-bar" :style="{ height: waveHeights[i-1] + 'px' }"></div>
              </div>

              <!-- Speaking ripples -->
              <div class="speak-ripple"></div>
              <div class="speak-ripple"></div>
              <div class="speak-ripple"></div>
            </div>
          </div>

          <!-- Status -->
          <div class="status-section">
            <h1 class="greeting">{{ greeting }}</h1>
            <p class="status-message">{{ statusMessage }}</p>
            <p class="last-check">All systems healthy</p>
          </div>

          <!-- Quick Actions -->
          <div class="quick-actions">
            <button
              v-for="action in quickActions"
              :key="action.id"
              class="quick-action"
              @click="handleQuickAction(action)"
            >{{ action.label }}</button>
          </div>

          <!-- Talk Button -->
          <div class="talk-section">
            <button class="talk-btn" :class="{ listening: isListening }" @click="toggleListening">
              <svg v-if="!isListening" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
              </svg>
              <svg v-else viewBox="0 0 24 24" fill="currentColor">
                <rect x="6" y="6" width="12" height="12" rx="2"/>
              </svg>
            </button>
            <span class="talk-hint">{{ isListening ? 'Listening...' : 'Tap to speak' }}</span>
          </div>
        </div>

        <!-- Conversation View -->
        <div class="conversation-view" :class="{ active: showConversation }">
          <div class="convo-header">
            <button class="convo-back" @click="closeConversation">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
              </svg>
            </button>
            <span class="convo-title">Dr. Vita</span>
            <button class="convo-escalate">Talk to Doctor</button>
          </div>

          <div class="messages" ref="messagesContainer">
            <div v-for="(msg, i) in messages" :key="i" class="message" :class="msg.sender">
              <div class="msg-bubble">{{ msg.text }}</div>
              <div class="msg-time">{{ msg.time }}</div>
            </div>
            <div v-if="isTyping" class="message vita">
              <div class="typing">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
              </div>
            </div>
          </div>

          <!-- Body Map Canvas -->
          <div class="canvas" :class="{ active: showBodyMap }">
            <div class="body-map-wrap">
              <svg viewBox="0 0 200 400">
                <ellipse cx="100" cy="40" rx="28" ry="32" class="body-part" :class="{ selected: selectedRegions.includes('head') }" @click="toggleRegion('head')"/>
                <rect x="88" y="72" width="24" height="18" rx="4" class="body-part" :class="{ selected: selectedRegions.includes('neck') }" @click="toggleRegion('neck')"/>
                <rect x="58" y="90" width="84" height="90" rx="8" class="body-part" :class="{ selected: selectedRegions.includes('torso') }" @click="toggleRegion('torso')"/>
                <rect x="22" y="94" width="32" height="70" rx="8" class="body-part" :class="{ selected: selectedRegions.includes('leftArm') }" @click="toggleRegion('leftArm')"/>
                <rect x="146" y="94" width="32" height="70" rx="8" class="body-part" :class="{ selected: selectedRegions.includes('rightArm') }" @click="toggleRegion('rightArm')"/>
                <rect x="60" y="185" width="36" height="110" rx="8" class="body-part" :class="{ selected: selectedRegions.includes('leftLeg') }" @click="toggleRegion('leftLeg')"/>
                <rect x="104" y="185" width="36" height="110" rx="8" class="body-part" :class="{ selected: selectedRegions.includes('rightLeg') }" @click="toggleRegion('rightLeg')"/>
              </svg>
            </div>
            <p class="body-instruction">Tap where you're experiencing discomfort</p>

            <div class="severity-wrap" v-if="selectedRegions.length">
              <div class="severity-labels">
                <span>Mild</span>
                <span>Severe</span>
              </div>
              <input type="range" min="1" max="10" v-model="severity" class="severity-slider"/>
              <div class="severity-value">{{ severity }}</div>
            </div>

            <button v-if="selectedRegions.length" class="canvas-btn" @click="submitBodyMap">Continue</button>
          </div>

          <!-- Triage Result -->
          <div class="canvas" :class="{ active: showTriage }">
            <div class="triage-card">
              <div class="triage-icon" :class="triage.level">{{ triage.icon }}</div>
              <div class="triage-level" :class="triage.level">{{ triage.levelText }}</div>
              <h2 class="triage-title">{{ triage.title }}</h2>
              <p class="triage-desc">{{ triage.desc }}</p>
              <div class="triage-actions">
                <button class="triage-btn primary" @click="handleTriageAction">{{ triage.primaryAction }}</button>
                <button class="triage-btn secondary" @click="closeTriage">{{ triage.secondaryAction }}</button>
              </div>
            </div>
          </div>

          <div class="convo-input">
            <input
              type="text"
              v-model="inputText"
              placeholder="Type a message..."
              @keyup.enter="sendMessage"
            />
            <button class="input-mic" :class="{ active: isListening }" @click="toggleListening">
              <svg v-if="!isListening" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
              </svg>
              <svg v-else viewBox="0 0 24 24" fill="currentColor">
                <rect x="6" y="6" width="12" height="12" rx="2"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Family Hub -->
        <div class="family-hub" :class="{ active: showFamily }">
          <div class="family-header">
            <h2 class="family-title">Health Circle</h2>
            <button class="family-close" @click="showFamily = false">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
          <div v-for="m in family" :key="m.id" class="family-member" @click="selectMember(m)">
            <div class="family-avatar">{{ m.initials }}</div>
            <div class="family-info">
              <div class="family-name">{{ m.name }}</div>
              <div class="family-relation">{{ m.relation }}</div>
            </div>
            <div class="family-status">
              <div class="family-dot" :class="m.status"></div>
              <span>{{ m.statusText }}</span>
            </div>
          </div>
          <button class="add-family">+ Add family member</button>
        </div>

        <!-- Bottom Nav -->
        <nav class="bottom-nav">
          <button class="nav-item" :class="{ active: tab === 'home' }" @click="tab = 'home'">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9,22 9,12 15,12 15,22"/>
            </svg>
            <span>Home</span>
          </button>
          <button class="nav-item" :class="{ active: tab === 'history' }" @click="tab = 'history'">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12,6 12,12 16,14"/>
            </svg>
            <span>History</span>
          </button>
          <button class="nav-item" @click="showFamily = true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
            <span>Family</span>
          </button>
          <button class="nav-item" :class="{ active: tab === 'meds' }" @click="tab = 'meds'">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10.5 20.5L3.5 13.5a4.95 4.95 0 1 1 7-7l10 10a4.95 4.95 0 1 1-7 7l-3-3"/>
              <path d="M8.5 8.5l7 7"/>
            </svg>
            <span>Meds</span>
          </button>
        </nav>
      </div>

      <!-- Disclaimer -->
      <div class="disclaimer" :class="{ visible: showDisclaimer }">
        <button class="disclaimer-close" @click="showDisclaimer = false">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        Dr. Vita is an AI assistant. It does not replace professional medical advice.
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script>
    const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;

    createApp({
      setup() {
        // State
        const currentTime = ref('');
        const isListening = ref(false);
        const isSpeaking = ref(false);
        const isThinking = ref(false);
        const showConversation = ref(false);
        const showFamily = ref(false);
        const showBodyMap = ref(false);
        const showTriage = ref(false);
        const showDisclaimer = ref(true);
        const tab = ref('home');
        const inputText = ref('');
        const messages = ref([]);
        const isTyping = ref(false);
        const messagesContainer = ref(null);
        const waveHeights = ref([20, 30, 40, 50, 40, 30, 20]);
        const selectedRegions = ref([]);
        const severity = ref(5);
        let waveInterval = null;

        const triage = ref({
          level: 'self-care',
          levelText: 'Self-Care',
          icon: 'âœ“',
          title: 'Rest & Monitor',
          desc: 'Based on your symptoms, this appears manageable at home. Stay hydrated and rest.',
          primaryAction: 'Got it',
          secondaryAction: 'Talk to a doctor anyway'
        });

        const quickActions = ref([
          { id: 'symptoms', label: "I don't feel well" },
          { id: 'meds', label: 'Check medications' },
          { id: 'history', label: 'Health history' }
        ]);

        const family = ref([
          { id: 1, name: 'You', initials: 'ME', relation: 'Primary', status: 'good', statusText: 'All good' },
          { id: 2, name: 'Sarah', initials: 'SK', relation: 'Spouse', status: 'good', statusText: 'All good' },
          { id: 3, name: 'Emma', initials: 'EK', relation: 'Daughter', status: 'attention', statusText: 'Mild cold' },
          { id: 4, name: 'Mom', initials: 'MK', relation: 'Mother', status: 'good', statusText: 'Meds due' }
        ]);

        const greeting = computed(() => {
          const h = new Date().getHours();
          if (h < 12) return 'Good morning';
          if (h < 18) return 'Good afternoon';
          return 'Good evening';
        });

        const statusMessage = computed(() => "I'm here whenever you need me. How are you feeling?");

        const updateTime = () => {
          currentTime.value = new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
        };

        const startWaves = () => {
          waveInterval = setInterval(() => {
            waveHeights.value = waveHeights.value.map(() => Math.random() * 40 + 15);
          }, 80);
        };

        const stopWaves = () => {
          clearInterval(waveInterval);
          waveHeights.value = [20, 30, 40, 50, 40, 30, 20];
        };

        const toggleListening = () => {
          isListening.value = !isListening.value;
          if (isListening.value) {
            startWaves();
            if (!showConversation.value) showConversation.value = true;
            setTimeout(() => {
              if (isListening.value) {
                isListening.value = false;
                stopWaves();
                const samples = [
                  "I've had a headache for two days",
                  "My throat is sore",
                  "I'm having trouble sleeping"
                ];
                inputText.value = samples[Math.floor(Math.random() * samples.length)];
                sendMessage();
              }
            }, 3000);
          } else {
            stopWaves();
          }
        };

        const handleQuickAction = (action) => {
          showConversation.value = true;
          if (action.id === 'symptoms') {
            addMessage("I don't feel well", 'user');
            respond("I'm sorry to hear that. Can you tell me more about how you're feeling?");
          } else if (action.id === 'meds') {
            addMessage("Check my medications", 'user');
            respond("You have 2 active medications. Lisinopril (10mg) is due tonight at 8pm.");
          } else {
            addMessage("Show my health history", 'user');
            respond("Last week: mild headache (resolved). 2 weeks ago: annual check-up with Dr. Chen.");
          }
        };

        const sendMessage = () => {
          if (!inputText.value.trim()) return;
          addMessage(inputText.value, 'user');
          const text = inputText.value.toLowerCase();
          inputText.value = '';

          if (text.includes('headache') || text.includes('head')) {
            respond("I understand. Let me ask a few questions. On a scale of 1-10, how bad is the pain? And can you show me where?");
            setTimeout(() => { showBodyMap.value = true; }, 1500);
          } else if (text.includes('throat') || text.includes('sore')) {
            respond("A sore throat could be several things. Do you have any fever? How long have you felt this way?");
          } else if (text.includes('sleep') || text.includes('tired')) {
            respond("Sleep issues can really affect you. I've noticed your patterns have been irregular. What's on your mind?");
          } else {
            respond("I hear you. Could you tell me a bit more so I can help?");
          }
        };

        const addMessage = (text, sender) => {
          messages.value.push({
            text,
            sender,
            time: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })
          });
          scrollToBottom();
        };

        const respond = (text) => {
          isTyping.value = true;
          isThinking.value = true;
          setTimeout(() => {
            isTyping.value = false;
            isThinking.value = false;
            isSpeaking.value = true;
            addMessage(text, 'vita');
            setTimeout(() => { isSpeaking.value = false; }, 2000);
          }, 1200 + Math.random() * 800);
        };

        const toggleRegion = (r) => {
          const i = selectedRegions.value.indexOf(r);
          if (i > -1) selectedRegions.value.splice(i, 1);
          else selectedRegions.value.push(r);
        };

        const submitBodyMap = () => {
          showBodyMap.value = false;
          const names = { head: 'head', neck: 'neck', torso: 'chest', leftArm: 'left arm', rightArm: 'right arm', leftLeg: 'left leg', rightLeg: 'right leg' };
          const regions = selectedRegions.value.map(r => names[r]).join(' and ');
          addMessage(`Pain in my ${regions}, severity ${severity.value}/10`, 'user');

          isTyping.value = true;
          setTimeout(() => {
            isTyping.value = false;
            if (severity.value >= 8) {
              triage.value = { level: 'urgent', levelText: 'Urgent', icon: '!', title: 'Seek Care Today', desc: 'Given the severity, I recommend seeing a provider today.', primaryAction: 'Find Urgent Care', secondaryAction: 'Talk to Vitable Doctor' };
            } else if (severity.value >= 5) {
              triage.value = { level: 'schedule', levelText: 'Schedule Visit', icon: 'â—', title: 'See a Doctor Soon', desc: 'Your symptoms suggest seeing a provider within 1-2 days.', primaryAction: 'Schedule Appointment', secondaryAction: 'Monitor for Now' };
            } else {
              triage.value = { level: 'self-care', levelText: 'Self-Care', icon: 'âœ“', title: 'Rest & Monitor', desc: 'This seems manageable at home. Rest and stay hydrated.', primaryAction: 'Got It', secondaryAction: 'See a Doctor Anyway' };
            }
            showTriage.value = true;
          }, 1500);
        };

        const handleTriageAction = () => {
          showTriage.value = false;
          respond("I've noted that. Anything else I can help with?");
        };

        const closeTriage = () => {
          showTriage.value = false;
          respond("No problem. Let me know if anything changes.");
        };

        const closeConversation = () => {
          showConversation.value = false;
          showBodyMap.value = false;
          showTriage.value = false;
          selectedRegions.value = [];
          severity.value = 5;
        };

        const selectMember = (m) => {
          showFamily.value = false;
          showConversation.value = true;
          messages.value = [];
          addMessage(`Switched to ${m.name}'s profile. How can I help?`, 'vita');
        };

        const scrollToBottom = () => {
          nextTick(() => {
            if (messagesContainer.value) {
              messagesContainer.value.scrollTop = messagesContainer.value.scrollHeight;
            }
          });
        };

        onMounted(() => {
          updateTime();
          setInterval(updateTime, 1000);
          setTimeout(() => { showDisclaimer.value = false; }, 5000);
        });

        watch(messages, scrollToBottom, { deep: true });

        return {
          currentTime, isListening, isSpeaking, isThinking,
          showConversation, showFamily, showBodyMap, showTriage, showDisclaimer,
          tab, inputText, messages, isTyping, messagesContainer,
          waveHeights, selectedRegions, severity, triage, quickActions, family,
          greeting, statusMessage,
          toggleListening, handleQuickAction, sendMessage, toggleRegion,
          submitBodyMap, handleTriageAction, closeTriage, closeConversation, selectMember
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
